<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Story Stains: Full Stack Enums | Sky</title><meta name=keywords content="rust,coding,actix,Story Stains,Flutter"><meta name=description content="Another post about building Story Stains, the previous one can be found at &ldquo;Story Stains: Frontend&rdquo;.
Enums Enums are a way of having multiple options programmatically, when a Boolean (true or false) isn&rsquo;t expressive enough. Think traffic lights: Red, Orange, Green, Http Status Codes: Unauthorized, Not Found, OK,&mldr;, and Countries: Germany, Poland, Great Britain, England? UK?&mldr;
Some things seem obviously able to fit into an Enum data type, until they don&rsquo;t."><meta name=author content="Sky Brewer"><link rel=canonical href=http://www.jacomago.dev/post/story_stains_enums/><link crossorigin=anonymous href=/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css integrity="sha256-yIlj/i15RiAA/Q+xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as=style><link rel=preload href=/apple-touch-icon.png as=image><script defer crossorigin=anonymous src=/assets/js/highlight.min.e85ad0406048e8176e1c7661b25d5c69297ddfe41dc4124cf75ecb99a4f7b3d1.js integrity="sha256-6FrQQGBI6BduHHZhsl1caSl93+QdxBJM917LmaT3s9E=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=http://www.jacomago.dev/favicon.ico%22><link rel=icon type=image/png sizes=16x16 href=http://www.jacomago.dev/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://www.jacomago.dev/favicon-32x32.png><link rel=apple-touch-icon href=http://www.jacomago.dev/apple-touch-icon.png><link rel=mask-icon href=http://www.jacomago.dev/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.101.0"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Story Stains: Full Stack Enums"><meta property="og:description" content="Another post about building Story Stains, the previous one can be found at &ldquo;Story Stains: Frontend&rdquo;.
Enums Enums are a way of having multiple options programmatically, when a Boolean (true or false) isn&rsquo;t expressive enough. Think traffic lights: Red, Orange, Green, Http Status Codes: Unauthorized, Not Found, OK,&mldr;, and Countries: Germany, Poland, Great Britain, England? UK?&mldr;
Some things seem obviously able to fit into an Enum data type, until they don&rsquo;t."><meta property="og:type" content="article"><meta property="og:url" content="http://www.jacomago.dev/post/story_stains_enums/"><meta property="og:image" content="http://www.jacomago.dev/paint_splatter.png"><meta property="article:section" content="post"><meta property="article:published_time" content="2022-07-16T17:03:38+02:00"><meta property="article:modified_time" content="2022-07-16T17:03:38+02:00"><meta property="og:site_name" content="Sky"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://www.jacomago.dev/paint_splatter.png"><meta name=twitter:title content="Story Stains: Full Stack Enums"><meta name=twitter:description content="Another post about building Story Stains, the previous one can be found at &ldquo;Story Stains: Frontend&rdquo;.
Enums Enums are a way of having multiple options programmatically, when a Boolean (true or false) isn&rsquo;t expressive enough. Think traffic lights: Red, Orange, Green, Http Status Codes: Unauthorized, Not Found, OK,&mldr;, and Countries: Germany, Poland, Great Britain, England? UK?&mldr;
Some things seem obviously able to fit into an Enum data type, until they don&rsquo;t."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://www.jacomago.dev/post/"},{"@type":"ListItem","position":2,"name":"Story Stains: Full Stack Enums","item":"http://www.jacomago.dev/post/story_stains_enums/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Story Stains: Full Stack Enums","name":"Story Stains: Full Stack Enums","description":"Another post about building Story Stains, the previous one can be found at \u0026ldquo;Story Stains: Frontend\u0026rdquo;.\nEnums Enums are a way of having multiple options programmatically, when a Boolean (true or false) isn\u0026rsquo;t expressive enough. Think traffic lights: Red, Orange, Green, Http Status Codes: Unauthorized, Not Found, OK,\u0026hellip;, and Countries: Germany, Poland, Great Britain, England? UK?\u0026hellip;\nSome things seem obviously able to fit into an Enum data type, until they don\u0026rsquo;t.","keywords":["rust","coding","actix","Story Stains","Flutter"],"articleBody":"Another post about building Story Stains, the previous one can be found at “Story Stains: Frontend”.\nEnums Enums are a way of having multiple options programmatically, when a Boolean (true or false) isn’t expressive enough. Think traffic lights: Red, Orange, Green, Http Status Codes: Unauthorized, Not Found, OK,…, and Countries: Germany, Poland, Great Britain, England? UK?…\nSome things seem obviously able to fit into an Enum data type, until they don’t. Emotions are what I was tackling. How many emotions can you feel when you watch a great film? Grief, Fear, Joy, Melancholy. The list may be large but it seems possible to do a suitable search in a dictionary or thesaurus and have a finite list, that’s unlikely to change much. So I thought to use an Enum in my backend.\nDatabase storage How do you store an Enum in a database? Postgres actually supports Enums, but the backend is where the API lives so surely it should be stored there? I decided to use an extra table, I wanted to store a name and a description for each emotion, pretty easy. I’ll then have the Enum stored in the backend so I don’t need to do database lookups, clever right?\nBut if the backend is the ultimate source of truth of the enum, how do I keep them in sync? Write a little sync function! So I wrote a little sync function to keep the database in sync with the emotions on start up, easy.\nMy staging app keeps failing in the sync check…\nMore Data Story stains is meant to be somewhat of a mood tracker for the stories you read or watch. What do mood trackers have? Cute little icons to represent the moods. So I need more info in the Enum, using strum I can add many more fields to my Enum, so why not one for an SVG location as well. I could store the whole SVG, but that would only make sense in the database, and that’s not the source of truth is it?\nWell, when I started adding the emotions to the review API, then I was doing joins on the Emotions table. So for that part of the API the Database table is the source of truth. My sync check seems a little silly now.\nMore emotions The first twenty one emotions I decided on were rather extreme: Cruelty, Horror, Betrayal,Disgust,… Reviewing the subtle short story ‘I stand here ironing’, I’m not sure I felt any of those. I need more emotions, and preferably a quicker way to add them than refactoring an Enum and with a linked migration in the database each time. Time to delete some enums.\n","wordCount":"448","inLanguage":"en","datePublished":"2022-07-16T17:03:38+02:00","dateModified":"2022-07-16T17:03:38+02:00","author":{"@type":"Person","name":"Sky Brewer"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://www.jacomago.dev/post/story_stains_enums/"},"publisher":{"@type":"Organization","name":"Sky","logo":{"@type":"ImageObject","url":"http://www.jacomago.dev/favicon.ico%22"}}}</script></head><body id=top><script>window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://www.jacomago.dev/ accesskey=h title="Sky (Alt + H)"><img src=http://www.jacomago.dev/apple-touch-icon.png alt=logo aria-label=logo height=35>Sky</a>
<span class=logo-switches></span></div><ul id=menu><li><a href=http://www.jacomago.dev/about/ title=about><span>about</span></a></li><li><a href=http://www.jacomago.dev/cv/ title=cv><span>cv</span></a></li><li><a href=http://www.jacomago.dev/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://www.jacomago.dev/>Home</a>&nbsp;»&nbsp;<a href=http://www.jacomago.dev/post/>Posts</a></div><h1 class=post-title>Story Stains: Full Stack Enums</h1><div class=post-meta><span title='2022-07-16 17:03:38 +0200 +0200'>July 16, 2022</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Sky Brewer</div></header><div class=post-content><p>Another post about building <a href=https://github.com/jacomago/storystains>Story Stains</a>, the previous one can be found at <a href=http://www.jacomago.dev/post/story_stains_frontend/>&ldquo;Story Stains: Frontend&rdquo;</a>.</p><h2 id=enums>Enums<a hidden class=anchor aria-hidden=true href=#enums>#</a></h2><p>Enums are a way of having multiple options programmatically, when a Boolean (true or false) isn&rsquo;t expressive enough. Think traffic lights: Red, Orange, Green, Http Status Codes: Unauthorized, Not Found, OK,&mldr;, and Countries: Germany, Poland, Great Britain, England? UK?&mldr;</p><p>Some things seem obviously able to fit into an Enum data type, until they don&rsquo;t. Emotions are what I was tackling. How many emotions can you feel when you watch a great film? Grief, Fear, Joy, Melancholy. The list may be large but it seems possible to do a suitable search in a dictionary or thesaurus and have a finite list, that&rsquo;s unlikely to change much. So I thought to use an Enum in my backend.</p><h2 id=database-storage>Database storage<a hidden class=anchor aria-hidden=true href=#database-storage>#</a></h2><p>How do you store an Enum in a database? Postgres actually supports Enums, but the backend is where the API lives so surely it should be stored there? I decided to use an extra table, I wanted to store a name and a description for each emotion, pretty easy. I&rsquo;ll then have the Enum stored in the backend so I don&rsquo;t need to do database lookups, clever right?</p><p>But if the backend is the ultimate source of truth of the enum, how do I keep them in sync? Write a little sync function! So I wrote a little sync function to keep the database in sync with the emotions on start up, easy.</p><p>My staging app keeps failing in the sync check&mldr;</p><h2 id=more-data>More Data<a hidden class=anchor aria-hidden=true href=#more-data>#</a></h2><p>Story stains is meant to be somewhat of a mood tracker for the stories you read or watch. What do mood trackers have? Cute little icons to represent the moods. So I need more info in the Enum, using <a href=https://crates.io/crates/strum>strum</a> I can add many more fields to my Enum, so why not one for an SVG location as well. I could store the whole SVG, but that would only make sense in the database, and that&rsquo;s not the source of truth is it?</p><p>Well, when I started adding the emotions to the review API, then I was doing joins on the Emotions table. So for that part of the API the Database table is the source of truth. My sync check seems a little silly now.</p><h2 id=more-emotions>More emotions<a hidden class=anchor aria-hidden=true href=#more-emotions>#</a></h2><p>The first twenty one emotions I decided on were rather extreme: Cruelty, Horror, Betrayal,Disgust,&mldr; Reviewing the subtle short story &lsquo;I stand here ironing&rsquo;, I&rsquo;m not sure I felt any of those. I need more emotions, and preferably a quicker way to add them than refactoring an Enum and with a linked migration in the database each time. Time to delete some enums.</p></div><footer class=post-footer><ul class=post-tags><li><a href=http://www.jacomago.dev/tags/rust/>rust</a></li><li><a href=http://www.jacomago.dev/tags/coding/>coding</a></li><li><a href=http://www.jacomago.dev/tags/actix/>actix</a></li><li><a href=http://www.jacomago.dev/tags/story-stains/>Story Stains</a></li><li><a href=http://www.jacomago.dev/tags/flutter/>Flutter</a></li></ul><nav class=paginav><a class=next href=http://www.jacomago.dev/post/story_stains_frontend/><span class=title>Next Page »</span><br><span>Story Stains: Frontend</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2022 <a href=http://www.jacomago.dev/>Sky</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script></body></html>