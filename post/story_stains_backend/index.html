<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Story Stains: The Backend | Sky</title><meta name=keywords content="rust,coding,actix,Story Stains"><meta name=description content="Another post about building Story Stains, the previous one can be found at &ldquo;Story Stains: An Idea forms&rdquo;.
Rust I like to follow trends as much as the next guy, so I&rsquo;m writing the backend in rust.
There were two main resources that I used:
&lsquo;Zero To Production In Rust&rsquo; (zero2prod), a great book about building a backend service from scratch using actix. It&rsquo;s what I based most of my server code on."><meta name=author content="Sky Brewer"><link rel=canonical href=http://www.jacomago.dev/post/story_stains_backend/><link crossorigin=anonymous href=/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css integrity="sha256-yIlj/i15RiAA/Q+xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as=style><link rel=preload href=/apple-touch-icon.png as=image><script defer crossorigin=anonymous src=/assets/js/highlight.min.e85ad0406048e8176e1c7661b25d5c69297ddfe41dc4124cf75ecb99a4f7b3d1.js integrity="sha256-6FrQQGBI6BduHHZhsl1caSl93+QdxBJM917LmaT3s9E=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=http://www.jacomago.dev/favicon.ico%22><link rel=icon type=image/png sizes=16x16 href=http://www.jacomago.dev/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://www.jacomago.dev/favicon-32x32.png><link rel=apple-touch-icon href=http://www.jacomago.dev/apple-touch-icon.png><link rel=mask-icon href=http://www.jacomago.dev/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.101.0"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Story Stains: The Backend"><meta property="og:description" content="Another post about building Story Stains, the previous one can be found at &ldquo;Story Stains: An Idea forms&rdquo;.
Rust I like to follow trends as much as the next guy, so I&rsquo;m writing the backend in rust.
There were two main resources that I used:
&lsquo;Zero To Production In Rust&rsquo; (zero2prod), a great book about building a backend service from scratch using actix. It&rsquo;s what I based most of my server code on."><meta property="og:type" content="article"><meta property="og:url" content="http://www.jacomago.dev/post/story_stains_backend/"><meta property="og:image" content="http://www.jacomago.dev/paint_splatter.png"><meta property="article:section" content="post"><meta property="article:published_time" content="2022-06-29T13:30:48+02:00"><meta property="article:modified_time" content="2022-06-29T13:30:48+02:00"><meta property="og:site_name" content="Sky"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://www.jacomago.dev/paint_splatter.png"><meta name=twitter:title content="Story Stains: The Backend"><meta name=twitter:description content="Another post about building Story Stains, the previous one can be found at &ldquo;Story Stains: An Idea forms&rdquo;.
Rust I like to follow trends as much as the next guy, so I&rsquo;m writing the backend in rust.
There were two main resources that I used:
&lsquo;Zero To Production In Rust&rsquo; (zero2prod), a great book about building a backend service from scratch using actix. It&rsquo;s what I based most of my server code on."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://www.jacomago.dev/post/"},{"@type":"ListItem","position":2,"name":"Story Stains: The Backend","item":"http://www.jacomago.dev/post/story_stains_backend/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Story Stains: The Backend","name":"Story Stains: The Backend","description":"Another post about building Story Stains, the previous one can be found at \u0026ldquo;Story Stains: An Idea forms\u0026rdquo;.\nRust I like to follow trends as much as the next guy, so I\u0026rsquo;m writing the backend in rust.\nThere were two main resources that I used:\n\u0026lsquo;Zero To Production In Rust\u0026rsquo; (zero2prod), a great book about building a backend service from scratch using actix. It\u0026rsquo;s what I based most of my server code on.","keywords":["rust","coding","actix","Story Stains"],"articleBody":"Another post about building Story Stains, the previous one can be found at “Story Stains: An Idea forms”.\nRust I like to follow trends as much as the next guy, so I’m writing the backend in rust.\nThere were two main resources that I used:\n‘Zero To Production In Rust’ (zero2prod), a great book about building a backend service from scratch using actix. It’s what I based most of my server code on. I enjoyed how each tiny step is broken down and that it’s written in a test driven methodology.\nRealWorld App, a community show case of examples in building a Medium clone. You can see code examples for the backend and frontend based on a single API. In particular a rust version by snamiki1212.\nAs I wanted to be mobile first, (most of my day to day is only phone after all) I didn’t want to build a server side html renderer, as in zero2prod. So I used the API design from the RealWorld App to start.\nI also swapped out the session based authentication from the zero2prod in favour of JWT. Likely, it’s something I plan to change in the future for an oauth2 implementation. Although any article on Hacker News about authentication has many negative opinions on oauth2 complexity and the ease of badly implementing JWT, so that might change my mind. Generally, I enjoy using my Google account as a login, so I will aim for that in the future.\nMistakes An aim of Story Stains is to teach myself programming a full stack application with deployment. I expect to make mistakes and learn from them.\nOne mistake was strictly following the RealWorld App’s API design. All of the POST or PUT methods involve sending a wrapper object, i.e.\n{ user: { username: 'fred', password: 'totallynotarobot' } } Rather than:\n{ username: 'fred', password: 'totallynotarobot' } It led me to write, in both the backend and frontend code, a lot of similar into_inner() methods.\nAnother mistake is using actix or rust in the first place. I chose them because I wanted to learn rust and I enjoyed the zero2prod book, and I have learnt a lot. Often, however, I yearn for the readymade admin interface, pre made queries and ORM from Django. The rust and actix ecosystem doesn’t give you nearly as much hand holding and requires you to spend a lot of time fitting parts together.\nI found this apparent when adding the emotion feature to the API and found I was writing a lot of repetitive code. I will aim to refactor it out and aim for DRY (don’t repeat yourself), but I’m essentially writing part of an ORM. For a one man band or small start-up, that’s a lot of work.\nBefore I felt quite sceptical about no-low-code backends like Firebase and it’s competitors, but I can really feel it’s appeal. The want to focus on business logic rather than application logic is high.\n","wordCount":"492","inLanguage":"en","datePublished":"2022-06-29T13:30:48+02:00","dateModified":"2022-06-29T13:30:48+02:00","author":{"@type":"Person","name":"Sky Brewer"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://www.jacomago.dev/post/story_stains_backend/"},"publisher":{"@type":"Organization","name":"Sky","logo":{"@type":"ImageObject","url":"http://www.jacomago.dev/favicon.ico%22"}}}</script></head><body id=top><script>window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://www.jacomago.dev/ accesskey=h title="Sky (Alt + H)"><img src=http://www.jacomago.dev/apple-touch-icon.png alt=logo aria-label=logo height=35>Sky</a>
<span class=logo-switches></span></div><ul id=menu><li><a href=http://www.jacomago.dev/about/ title=about><span>about</span></a></li><li><a href=http://www.jacomago.dev/cv/ title=cv><span>cv</span></a></li><li><a href=http://www.jacomago.dev/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://www.jacomago.dev/>Home</a>&nbsp;»&nbsp;<a href=http://www.jacomago.dev/post/>Posts</a></div><h1 class=post-title>Story Stains: The Backend</h1><div class=post-meta><span title='2022-06-29 13:30:48 +0200 +0200'>June 29, 2022</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Sky Brewer</div></header><div class=post-content><p>Another post about building <a href=https://github.com/jacomago/storystains>Story Stains</a>, the previous one can be found at <a href=http://www.jacomago.dev/post/story_stains_idea_forms/>&ldquo;Story Stains: An Idea forms&rdquo;</a>.</p><h2 id=rust>Rust<a hidden class=anchor aria-hidden=true href=#rust>#</a></h2><p>I like to follow trends as much as the next guy, so I&rsquo;m writing the backend in rust.</p><p>There were two main resources that I used:</p><ul><li><p><a href=https://www.zero2prod.com>&lsquo;Zero To Production In Rust&rsquo; (zero2prod)</a>, a great book about building a backend service from scratch using <a href=https://actix.rs/>actix</a>. It&rsquo;s what I based most of my server code on. I enjoyed how each tiny step is broken down and that it&rsquo;s written in a test driven methodology.</p></li><li><p><a href=https://realworld-docs.netlify.app/>RealWorld App</a>, a community show case of examples in building a Medium clone. You can see code examples for the backend and frontend based on a single API. In particular a rust version by <a href=https://github.com/snamiki1212/realworld-v1-rust-actix-web-diesel>snamiki1212</a>.</p></li></ul><p>As I wanted to be mobile first, (most of my day to day is only phone after all) I didn&rsquo;t want to build a server side html renderer, as in zero2prod. So I used the API design from the RealWorld App to start.</p><p>I also swapped out the session based authentication from the zero2prod in favour of JWT. Likely, it&rsquo;s something I plan to change in the future for an oauth2 implementation. Although any article on Hacker News about authentication has many negative opinions on oauth2 complexity and the ease of badly implementing JWT, so that might change my mind. Generally, I enjoy using my Google account as a login, so I will aim for that in the future.</p><h2 id=mistakes>Mistakes<a hidden class=anchor aria-hidden=true href=#mistakes>#</a></h2><p>An aim of Story Stains is to teach myself programming a full stack application with deployment. I expect to make mistakes and learn from them.</p><p>One mistake was strictly following the RealWorld App&rsquo;s API design. All of the POST or PUT methods involve sending a wrapper object, i.e.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>user</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>username</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;fred&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>password</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;totallynotarobot&#39;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Rather than:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>username</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;fred&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>password</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;totallynotarobot&#39;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>It led me to write, in both the backend and frontend code, a lot of similar into_inner() methods.</p><p>Another mistake is using actix or rust in the first place. I chose them because I wanted to learn rust and I enjoyed the zero2prod book, and I have learnt a lot. Often, however, I yearn for the readymade admin interface, pre made queries and ORM from Django. The rust and actix ecosystem doesn&rsquo;t give you nearly as much hand holding and requires you to spend a lot of time fitting parts together.</p><p>I found this apparent when adding the emotion feature to the API and found I was writing a lot of repetitive code. I will aim to refactor it out and aim for DRY (don&rsquo;t repeat yourself), but I&rsquo;m essentially writing part of an ORM. For a one man band or small start-up, that&rsquo;s a lot of work.</p><p>Before I felt quite sceptical about no-low-code backends like Firebase and it&rsquo;s competitors, but I can really feel it&rsquo;s appeal. The want to focus on business logic rather than application logic is high.</p></div><footer class=post-footer><ul class=post-tags><li><a href=http://www.jacomago.dev/tags/rust/>rust</a></li><li><a href=http://www.jacomago.dev/tags/coding/>coding</a></li><li><a href=http://www.jacomago.dev/tags/actix/>actix</a></li><li><a href=http://www.jacomago.dev/tags/story-stains/>Story Stains</a></li></ul><nav class=paginav><a class=prev href=http://www.jacomago.dev/post/story_stains_frontend/><span class=title>« Prev Page</span><br><span>Story Stains: Frontend</span></a>
<a class=next href=http://www.jacomago.dev/post/story_stains_idea_forms/><span class=title>Next Page »</span><br><span>Story Stains: An Idea forms</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2022 <a href=http://www.jacomago.dev/>Sky</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script></body></html>